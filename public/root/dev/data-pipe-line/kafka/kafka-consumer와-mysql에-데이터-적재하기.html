<!DOCTYPE html> <html><head>
		<title>Kafka Consumer와 MySQL에 데이터 적재하기</title>
		<base href="..\..\..\../">
		<meta id="root-path" root-path="..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="note - Kafka Consumer와 MySQL에 데이터 적재하기">
		<meta property="og:title" content="Kafka Consumer와 MySQL에 데이터 적재하기">
		<meta property="og:description" content="note - Kafka Consumer와 MySQL에 데이터 적재하기">
		<meta property="og:type" content="website">
		<meta property="og:url" content="root/dev/data-pipe-line/kafka/kafka-consumer와-mysql에-데이터-적재하기.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="note">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon zoom-plugin-bls-zoom horizontal-to-vertical"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> kafka
  <span class="token punctuation">-</span> mysql
  <span class="token punctuation">-</span> code
<span class="token key atrule">create</span><span class="token punctuation">:</span> <span class="token datetime number">2024-07-30 00:30:24</span></code><button class="copy-code-button">복사</button></pre><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Kafka Consumer와 MySQL에 데이터 적재하기"><p dir="auto">Kafka Consumer와 MySQL에 데이터 적재하기</p></h1><div class="el-h2 heading-wrapper"><h2 data-heading="flow" dir="auto" class="heading" id="flow"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>flow</h2><div class="heading-children"><div class="el-pre admonition-parent admonition-info-parent"><div class="callout admonition admonition-info admonition-plugin no-drop" style="--callout-color: 0, 184, 212;" data-callout="info" data-callout-fold="" data-callout-metadata=""><div class="callout-title admonition-title "><div class="callout-icon admonition-title-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="info-circle" class="svg-inline--fa fa-info-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"></path></svg></div><div class="callout-title-inner admonition-title-content">Info</div></div><div class="callout-content admonition-content"><p dir="auto">csv -&gt; python -&gt; kafka -&gt; mysql</p></div></div></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="pip install" dir="auto" class="heading" id="pip_install"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>pip install</h2><div class="heading-children"><div class="el-pre"><pre class="language-sh" tabindex="0"><code data-line="0" class="language-sh is-loaded">pip install kafka-python pandas sqlalchemy pymysql
</code><button class="copy-code-button">복사</button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="code" dir="auto" class="heading" id="code"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>code</h2><div class="heading-children"><div class="el-pre"><pre class="language-sh" tabindex="0"><code data-line="0" class="language-sh is-loaded">vi kafka_consumer_mysql.py
</code><button class="copy-code-button">복사</button></pre></div><div class="el-pre has-run-code-button"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded"><span class="token keyword">from</span> kafka <span class="token keyword">import</span> KafkaProducer<span class="token punctuation">,</span> KafkaConsumer
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json
<span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine<span class="token punctuation">,</span> Table<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> MetaData<span class="token punctuation">,</span> inspect
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>types <span class="token keyword">import</span> String<span class="token punctuation">,</span> BigInteger<span class="token punctuation">,</span> Float<span class="token punctuation">,</span> DateTime
<span class="token keyword">import</span> pymysql

CSV_DATA <span class="token operator">=</span> <span class="token string">'data_mini.csv'</span>

<span class="token comment"># 데이터베이스 연결 설정</span>
DATABASE_USER <span class="token operator">=</span> <span class="token string">'ubuntu'</span>
DATABASE_PASSWORD <span class="token operator">=</span> <span class="token string">'1234'</span>
DATABASE_HOST <span class="token operator">=</span> <span class="token string">'localhost'</span>
DATABASE_NAME <span class="token operator">=</span> <span class="token string">'my_data'</span>

<span class="token comment"># Kafka 설정</span>
KAFKA_BOOTSTRAP_SERVERS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'172.17.0.2:9092'</span><span class="token punctuation">,</span> <span class="token string">'172.17.0.3:9092'</span><span class="token punctuation">,</span> <span class="token string">'172.17.0.4:9092'</span><span class="token punctuation">]</span>
KAFKA_TOPIC <span class="token operator">=</span> <span class="token string">'testtopic'</span>
KAFKA_GROUP_ID <span class="token operator">=</span> <span class="token string">'my-group'</span>  <span class="token comment"># group_id 설정</span>

<span class="token comment"># 데이터베이스 연결 함수</span>
<span class="token keyword">def</span> <span class="token function">create_database_if_not_exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
		host<span class="token operator">=</span>DATABASE_HOST<span class="token punctuation">,</span>
		user<span class="token operator">=</span>DATABASE_USER<span class="token punctuation">,</span>
		password<span class="token operator">=</span>DATABASE_PASSWORD
	<span class="token punctuation">)</span>
	<span class="token keyword">try</span><span class="token punctuation">:</span>
		<span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>
			cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"CREATE DATABASE IF NOT EXISTS </span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_NAME<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
	<span class="token keyword">finally</span><span class="token punctuation">:</span>
		connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># SQLAlchemy 데이터 타입 매핑 함수</span>
<span class="token keyword">def</span> <span class="token function">get_sqlalchemy_type</span><span class="token punctuation">(</span>dtype<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> pd<span class="token punctuation">.</span>api<span class="token punctuation">.</span>types<span class="token punctuation">.</span>is_integer_dtype<span class="token punctuation">(</span>dtype<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> BigInteger
	<span class="token keyword">elif</span> pd<span class="token punctuation">.</span>api<span class="token punctuation">.</span>types<span class="token punctuation">.</span>is_float_dtype<span class="token punctuation">(</span>dtype<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> Float
	<span class="token keyword">elif</span> pd<span class="token punctuation">.</span>api<span class="token punctuation">.</span>types<span class="token punctuation">.</span>is_datetime64_any_dtype<span class="token punctuation">(</span>dtype<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> DateTime
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> String<span class="token punctuation">(</span>length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>

<span class="token comment"># 데이터베이스 및 테이블 설정</span>
<span class="token keyword">def</span> <span class="token function">setup_database_and_table</span><span class="token punctuation">(</span>csv_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
	engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'mysql+pymysql://</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_USER<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_PASSWORD<span class="token punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_HOST<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_NAME<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
	
	df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>csv_path<span class="token punctuation">)</span>
	
	metadata <span class="token operator">=</span> MetaData<span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	columns <span class="token operator">=</span> <span class="token punctuation">[</span>Column<span class="token punctuation">(</span>col<span class="token punctuation">,</span> get_sqlalchemy_type<span class="token punctuation">(</span>df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">]</span>
	table <span class="token operator">=</span> Table<span class="token punctuation">(</span><span class="token string">'test_a'</span><span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> <span class="token operator">*</span>columns<span class="token punctuation">)</span>
	
	inspector <span class="token operator">=</span> inspect<span class="token punctuation">(</span>engine<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token keyword">not</span> inspector<span class="token punctuation">.</span>has_table<span class="token punctuation">(</span><span class="token string">'test_a'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		metadata<span class="token punctuation">.</span>create_all<span class="token punctuation">(</span>engine<span class="token punctuation">)</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Table 'test_a' created successfully from CSV file."</span></span><span class="token punctuation">)</span>
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Table 'test_a' already exists."</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">produce_csv_to_kafka</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> topic<span class="token punctuation">)</span><span class="token punctuation">:</span>
	data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
	producer <span class="token operator">=</span> KafkaProducer<span class="token punctuation">(</span>
		bootstrap_servers<span class="token operator">=</span>KAFKA_BOOTSTRAP_SERVERS<span class="token punctuation">,</span>
		value_serializer<span class="token operator">=</span><span class="token keyword">lambda</span> v<span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
	<span class="token punctuation">)</span>
	
	<span class="token keyword">for</span> _<span class="token punctuation">,</span> row <span class="token keyword">in</span> data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		message <span class="token operator">=</span> row<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>
		producer<span class="token punctuation">.</span>send<span class="token punctuation">(</span>topic<span class="token punctuation">,</span> value<span class="token operator">=</span>message<span class="token punctuation">)</span>
	producer<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
	producer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CSV 데이터를 Kafka에 게시 완료."</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">load_data_to_mysql</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
	engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'mysql+pymysql://</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_USER<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_PASSWORD<span class="token punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_HOST<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>DATABASE_NAME<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
	df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
	df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span><span class="token string">'test_a'</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> if_exists<span class="token operator">=</span><span class="token string">'append'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

consumer <span class="token operator">=</span> KafkaConsumer<span class="token punctuation">(</span>
	KAFKA_TOPIC<span class="token punctuation">,</span>
	bootstrap_servers<span class="token operator">=</span>KAFKA_BOOTSTRAP_SERVERS<span class="token punctuation">,</span>
	auto_offset_reset<span class="token operator">=</span><span class="token string">'earliest'</span><span class="token punctuation">,</span>
	enable_auto_commit<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
	group_id<span class="token operator">=</span>KAFKA_GROUP_ID<span class="token punctuation">,</span>  <span class="token comment"># group_id 추가</span>
	value_deserializer<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>x<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

create_database_if_not_exists<span class="token punctuation">(</span><span class="token punctuation">)</span>
setup_database_and_table<span class="token punctuation">(</span>CSV_DATA<span class="token punctuation">)</span>

produce_csv_to_kafka<span class="token punctuation">(</span>CSV_DATA<span class="token punctuation">,</span> KAFKA_TOPIC<span class="token punctuation">)</span>

data_buffer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
buffer_limit <span class="token operator">=</span> <span class="token number">100</span>
timeout_ms <span class="token operator">=</span> <span class="token number">500</span>  <span class="token comment"># 5초 동안 새로운 메시지가 없으면 타임아웃</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
	message_pack <span class="token operator">=</span> consumer<span class="token punctuation">.</span>poll<span class="token punctuation">(</span>timeout_ms<span class="token operator">=</span>timeout_ms<span class="token punctuation">)</span>
	
	<span class="token keyword">if</span> <span class="token keyword">not</span> message_pack<span class="token punctuation">:</span>
		<span class="token keyword">break</span>
	
	<span class="token keyword">for</span> tp<span class="token punctuation">,</span> messages <span class="token keyword">in</span> message_pack<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">for</span> message <span class="token keyword">in</span> messages<span class="token punctuation">:</span>
			data_buffer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>message<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
			
			<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_buffer<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> buffer_limit<span class="token punctuation">:</span>
				load_data_to_mysql<span class="token punctuation">(</span>data_buffer<span class="token punctuation">)</span>
				data_buffer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
				consumer<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> data_buffer<span class="token punctuation">:</span>
	load_data_to_mysql<span class="token punctuation">(</span>data_buffer<span class="token punctuation">)</span>
	consumer<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

consumer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Kafka에서 MySQL로 데이터 적재 완료."</span><span class="token punctuation">)</span>

</code><button class="copy-code-button">복사</button><button class="run-code-button">Run</button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="코드 설명" dir="auto" class="heading" id="코드_설명"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>코드 설명</h2><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Kafka Consumer 설정</strong>:</p>
<ul>
<li data-line="1" dir="auto"><code class="code-styler-inline">KafkaConsumer</code>를 사용하여 지정된 토픽(<code class="code-styler-inline">my_topic</code>)에서 메시지를 소비합니다.</li>
<li data-line="2" dir="auto"><code class="code-styler-inline">bootstrap_servers</code>에는 Kafka 클러스터의 브로커 주소를 지정합니다.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>MySQL 데이터베이스와 테이블 설정</strong>:</p>
<ul>
<li data-line="5" dir="auto">데이터베이스와 테이블이 존재하지 않으면 새로 생성합니다.</li>
</ul>
</li>
<li data-line="7" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>데이터 적재 함수 (<code class="code-styler-inline">load_data_to_mysql</code>)</strong>:</p>
<ul>
<li data-line="8" dir="auto">Kafka에서 받은 메시지를 <code class="code-styler-inline">pandas</code> 데이터프레임으로 변환하고, <code class="code-styler-inline">to_sql</code> 메서드를 사용하여 MySQL에 데이터를 적재합니다.</li>
<li data-line="9" dir="auto"><code class="code-styler-inline">if_exists='append'</code> 옵션을 사용하여 기존 테이블에 데이터를 추가합니다.</li>
</ul>
</li>
<li data-line="11" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Kafka에서 메시지 소비 및 MySQL에 적재</strong>:</p>
<ul>
<li data-line="12" dir="auto">Kafka에서 메시지를 소비하여 <code class="code-styler-inline">data_buffer</code>에 저장합니다.</li>
<li data-line="13" dir="auto">버퍼의 데이터 수가 일정 한도(<code class="code-styler-inline">buffer_limit</code>)를 넘으면, <code class="code-styler-inline">load_data_to_mysql</code> 함수를 호출하여 MySQL에 데이터를 적재합니다.</li>
<li data-line="14" dir="auto">버퍼가 비워진 후에도 데이터가 남아 있으면, 마지막으로 MySQL에 적재합니다.</li>
</ul>
</li>
</ol></div><div class="el-h3 heading-wrapper"><h3 data-heading="주의 사항" dir="auto" class="heading" id="주의_사항"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>주의 사항</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p><strong>데이터 변환</strong>: Kafka에서 받은 데이터는 JSON 형식으로 변환되므로, MySQL의 테이블 구조에 맞게 데이터 변환이 필요할 수 있습니다. 실제 환경에서는 데이터를 필터링하거나 변환할 필요가 있을 수 있습니다.</p>
</li>
<li data-line="2" dir="auto">
<p><strong>에러 처리</strong>: 실제 사용 시에는 예외 처리 및 로그 기록을 추가하여 오류를 모니터링하고 대응할 수 있습니다.</p>
</li>
<li data-line="4" dir="auto">
<p><strong>성능 고려</strong>: 데이터 적재 성능을 높이기 위해, 데이터 배치 처리(batch processing)나 병렬 처리를 고려할 수 있습니다.</p>
</li>
</ul></div><div class="el-p"><p dir="auto">이 코드는 실시간으로 Kafka에서 데이터를 소비하고 MySQL에 적재할 수 있도록 설계되었으며, 데이터가 지속적으로 들어오는 환경에서 유용합니다.</p></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="비교 설명" dir="auto" class="heading" id="비교_설명"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>비교 설명</h2><div class="heading-children"><div class="el-pre admonition-parent admonition-info-parent"><div class="callout admonition admonition-info admonition-plugin no-drop" style="--callout-color: 0, 184, 212;" data-callout="info" data-callout-fold="" data-callout-metadata=""><div class="callout-title admonition-title "><div class="callout-icon admonition-title-icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="info-circle" class="svg-inline--fa fa-info-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"></path></svg></div><div class="callout-title-inner admonition-title-content">Info</div></div><div class="callout-content admonition-content"><p dir="auto">데이터를 MySQL에 적재할 때, Kafka를 거치는 것과 직접 MySQL에 적재하는 것 사이에는 여러 가지 차이점과 고려할 사항이 있습니다. 아래에 각각의 방법이 데이터베이스에 미치는 영향과 안정성에 대해 비교하여 설명하겠습니다.</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="1. Kafka를 통한 데이터 적재" dir="auto" class="heading" id="1._Kafka를_통한_데이터_적재"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. Kafka를 통한 데이터 적재</h3><div class="heading-children"><div class="el-p"><p dir="auto"><strong>장점:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>내결함성 (Fault Tolerance)</strong>:</p>
<ul>
<li data-line="1" dir="auto">Kafka는 메시지의 내구성을 보장하고 데이터 복제를 통해 장애에 대비할 수 있습니다. Kafka에 데이터가 게시되면, Kafka는 이를 복제하고 유지하여 MySQL 데이터베이스가 다운되더라도 데이터 손실을 방지할 수 있습니다.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>성능 향상 (Performance)</strong>:</p>
<ul>
<li data-line="4" dir="auto">Kafka는 데이터를 버퍼링하고, 배치로 처리하여 대량의 데이터를 효율적으로 처리합니다. 이로 인해 MySQL 데이터베이스에 직접적인 부하를 줄일 수 있습니다.</li>
</ul>
</li>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>비동기 처리 (Asynchronous Processing)</strong>:</p>
<ul>
<li data-line="7" dir="auto">Kafka는 비동기 처리 모델을 사용하여 데이터 전송과 처리를 분리합니다. 이를 통해 데이터 수집과 처리의 병목 현상을 줄일 수 있습니다.</li>
</ul>
</li>
<li data-line="9" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>확장성 (Scalability)</strong>:</p>
<ul>
<li data-line="10" dir="auto">Kafka는 클러스터 기반으로 설계되어 데이터의 양이 증가하더라도 확장 가능성을 제공합니다. Kafka의 파티셔닝 및 복제 기능을 활용하여 데이터 처리량을 높일 수 있습니다.</li>
</ul>
</li>
</ol></div><div class="el-p"><p dir="auto"><strong>단점:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>복잡성 증가 (Increased Complexity)</strong>:</p>
<ul>
<li data-line="1" dir="auto">Kafka를 추가하면 시스템의 복잡성이 증가합니다. Kafka 브로커의 설정, 모니터링, 유지 관리가 필요합니다.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>지연 (Latency)</strong>:</p>
<ul>
<li data-line="4" dir="auto">Kafka를 경유하면 데이터 전송에 약간의 지연이 있을 수 있습니다. 하지만 이는 일반적으로 성능 향상과 데이터 안정성을 고려할 때 감수할 수 있는 부분입니다.</li>
</ul>
</li>
</ol></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="2. Kafka 없이 직접 MySQL에 데이터 적재" dir="auto" class="heading" id="2._Kafka_없이_직접_MySQL에_데이터_적재"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. Kafka 없이 직접 MySQL에 데이터 적재</h3><div class="heading-children"><div class="el-p"><p dir="auto"><strong>장점:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>간단한 아키텍처 (Simpler Architecture)</strong>:</p>
<ul>
<li data-line="1" dir="auto">Kafka를 사용하지 않으면 데이터 전송 경로가 간단해지며 시스템이 간결해집니다. 설정 및 유지 관리가 단순해질 수 있습니다.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>즉각적인 데이터 적재 (Immediate Data Insertion)</strong>:</p>
<ul>
<li data-line="4" dir="auto">데이터가 직접적으로 MySQL에 적재되므로 지연이 적을 수 있습니다.</li>
</ul>
</li>
</ol></div><div class="el-p"><p dir="auto"><strong>단점:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>부하 (Load)</strong>:</p>
<ul>
<li data-line="1" dir="auto">MySQL에 직접적으로 데이터를 적재할 경우, 데이터베이스에 큰 부하를 줄 수 있습니다. 특히 대량의 데이터가 동시에 들어오면 MySQL의 성능이 저하될 수 있습니다.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>내결함성 부족 (Lack of Fault Tolerance)</strong>:</p>
<ul>
<li data-line="4" dir="auto">MySQL에 직접 데이터를 적재하는 경우, 데이터베이스의 장애나 다운타임에 대한 대비책이 부족할 수 있습니다. 데이터 손실이나 서비스 중단의 위험이 존재합니다.</li>
</ul>
</li>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>확장성 문제 (Scalability Issues)</strong>:</p>
<ul>
<li data-line="7" dir="auto">데이터량이 증가할수록 MySQL의 성능이 저하될 수 있으며, 클러스터를 사용하지 않는 경우 데이터베이스의 확장에 한계가 있을 수 있습니다.</li>
</ul>
</li>
<li data-line="9" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>동기 처리 (Synchronous Processing)</strong>:</p>
<ul>
<li data-line="10" dir="auto">데이터 적재가 동기식으로 처리되면 데이터베이스의 응답 시간과 부하에 영향을 받을 수 있습니다.</li>
</ul>
</li>
</ol></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="결론" dir="auto" class="heading" id="결론"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>결론</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p><strong>Kafka를 사용하는 경우</strong>: Kafka는 데이터의 내결함성과 확장성을 제공하며, 대량의 데이터를 처리할 때 안정성을 높입니다. MySQL에 대한 부하를 줄이고, 장애 발생 시 데이터 손실을 방지할 수 있습니다. Kafka는 비동기식 데이터 전송을 통해 성능을 향상시키지만, 시스템의 복잡성이 증가할 수 있습니다.</p>
</li>
<li data-line="2" dir="auto">
<p><strong>Kafka 없이 직접 MySQL에 적재하는 경우</strong>: 시스템이 간단해지고 즉각적인 데이터 적재가 가능하지만, 데이터베이스에 부하가 증가하고 내결함성과 확장성에 한계가 있을 수 있습니다. 특히 대량의 데이터가 있을 때 안정성 문제를 겪을 수 있습니다.</p>
</li>
</ul></div><div class="el-p"><p dir="auto">따라서, 데이터의 양과 시스템의 요구 사항에 따라 적절한 접근 방식을 선택하는 것이 중요합니다. 대량의 데이터 처리와 높은 안정성이 필요하다면 Kafka를 사용하는 것이 좋습니다. 반면, 데이터량이 상대적으로 적고 시스템의 복잡성을 줄이려는 경우 직접 MySQL에 적재하는 것도 고려할 수 있습니다.</p></div><div class="mod-footer mod-ui"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#Kafka Consumer와 MySQL에 데이터 적재하기"><div class="tree-item-contents heading-link" heading-name="Kafka Consumer와 MySQL에 데이터 적재하기"><span class="tree-item-title">Kafka Consumer와 MySQL에 데이터 적재하기</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#flow"><div class="tree-item-contents heading-link" heading-name="flow"><span class="tree-item-title">flow</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#pip_install"><div class="tree-item-contents heading-link" heading-name="pip install"><span class="tree-item-title">pip install</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#code"><div class="tree-item-contents heading-link" heading-name="code"><span class="tree-item-title">code</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#코드_설명"><div class="tree-item-contents heading-link" heading-name="코드 설명"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">코드 설명</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#주의_사항"><div class="tree-item-contents heading-link" heading-name="주의 사항"><span class="tree-item-title">주의 사항</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#비교_설명"><div class="tree-item-contents heading-link" heading-name="비교 설명"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">비교 설명</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#1._Kafka를_통한_데이터_적재"><div class="tree-item-contents heading-link" heading-name="1. Kafka를 통한 데이터 적재"><span class="tree-item-title">1. 
Kafka를 통한 데이터 적재
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#2._Kafka_없이_직접_MySQL에_데이터_적재"><div class="tree-item-contents heading-link" heading-name="2. Kafka 없이 직접 MySQL에 데이터 적재"><span class="tree-item-title">2. 
Kafka 없이 직접 MySQL에 데이터 적재
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="root\dev\data-pipe-line\kafka\kafka-consumer와-mysql에-데이터-적재하기.html#결론"><div class="tree-item-contents heading-link" heading-name="결론"><span class="tree-item-title">결론</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>